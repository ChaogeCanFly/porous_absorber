<!DOCTYPE html>
<html>
<head>
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
  <link rel="stylesheet" href="styles/normalize.css">
  <link rel="stylesheet" href="styles/style.css">

  <title>Porous Absorber Calculator</title>

  <script src="./js/src.js"></script>
  <script type="module">
      // Get reference to the JavaScript wrapper function generated by wasm-pack
      import init, {porous_absorber_calculator} from './pkg/porous_absorber_calculator.js'
  
      // Make JavaScript wrapper function accessible to coding outside this module
      window.pa_calculator = porous_absorber_calculator
  
      // Start the engine...
      async function run() {
        await init()
        console.log("WASM module initialisation complete...")
        update_screen()
      }
  
      // Off we go...
      run()
    </script>
  </head>

  <body>
    <h1>Porous Absorber Calculator</h1>
    <p>To see the graph in standard analysis frequencies, select "Whole octaves" and set the start frequency to 62.5Hz</p>

    <!-- Input parameters table -->
    <div class="param_table">
      <div class="param_row">
        <div class="param_cell">
          <div class="param_row">
            <div class="param_cell desc">Absorber thickness (t<sub>a</sub>)</div>
            <div class="param_cell"><input type="range" min="5" max="500" step="1" value="30" id="absorber_thickness_mm" oninput="update_screen()"></div>
            <div class="param_cell unit" id="absorber_thickness_mm_value"></div>
            <div class="param_cell alt_unit" id="absorber_thickness_mm_units"></div>
          </div>
      
          <div class="param_row">
            <div class="param_cell desc">Absorber flow resistivity (&sigma;)</div>
            <div class="param_cell"><input type="range" min="100" max="100000" step="100" value="16500" id="flow_resistivity" oninput="update_screen()"></div>
            <div class="param_cell unit" id="flow_resistivity_value"></div>
          </div>

          <div class="param_row">
            <div class="param_cell desc">Cavity air gap (d)</div>
            <div class="param_cell"><input type="range" min="0" max="500" step="1" value="100" id="air_gap_mm" oninput="update_screen()"></div>
            <div class="param_cell unit" id="air_gap_mm_value"></div>
            <div class="param_cell alt_unit" id="air_gap_mm_units"></div>
          </div>

          <div class="param_row">
            <div class="param_cell desc">Angle of incidence (&phi;)</div>
            <div class="param_cell"><input type="range" min="0" max="89" step="1" value="0" id="angle" oninput="update_screen()"></div>
            <div class="param_cell unit" id="angle_value"></div>
            <div class="param_cell alt_unit" id="angle_units"></div>
          </div>
        </div>
  
        <div class="param_cell">
          <div class="param_row">
            <div class="param_cell desc">Air temperature</div>
            <div class="param_cell"><input type="range" min="-20" max="100" step="1" value="20" id="air_temp" oninput="update_screen()"></div>
            <div class="param_cell unit" id="air_temp_value"></div>
          </div>

          <div class="param_row">
            <div class="param_cell desc">Air pressure</div>
            <div class="param_cell"><input type="range" min="0.800" max="1.100" step="0.001" value="1.000" id="air_pressure" oninput="update_screen()"></div>
            <div class="param_cell unit" id="air_pressure_value"></div>
          </div>

          <div class="param_row">
            <div class="param_cell desc">Start graph at</div>
            <div class="param_cell"><input type="range" min="20" max="100" step="0.5" value="62.5" id="start_graph_freq" oninput="update_screen()"></div>
            <div class="param_cell unit" id="start_graph_freq_value"></div>
          </div>
        </div>
  
        <div class="param_cell">
          <div class="param_row">
            <div class="param_cell desc">Octave subdivisions</div>
            <div class="param_cell">
              <input type="radio" id="subdivision1" name="subdivision" value="1" checked onchange="update_screen()">
              <label for="subdivision1">Whole</label><br>
              <input type="radio" id="subdivision2" name="subdivision" value="2" onchange="update_screen()">
              <label for="subdivision2">Half</label><br>
              <input type="radio" id="subdivision3" name="subdivision" value="3" onchange="update_screen()">
              <label for="subdivision3">Third</label><br>
              <input type="radio" id="subdivision4" name="subdivision" value="6" onchange="update_screen()">
              <label for="subdivision4">Sixth</label>
            </div>
          </div>
        </div>
      </div>
    </div>
  
    <canvas id="graph_canvas" width="1200" height="675"></canvas>
  </body>
</html>